"0","## In this analysis, we aim to compare the age distribution of counselors and psychologists across different states in the US. Specifically, we focus on the proportions of professionals below and above the age of 60. Understanding the age distribution within these professions can provide insights into workforce demographics, potential retirement trends, and future workforce planning. By leveraging graphical methods, we can visualize and summarize the data to reveal patterns and trends in the age distribution of mental health professionals."
"0",""
"0",""
"0","# Calculate age group proportions for counselors and psychologists"
"0","data <- data %>%"
"0","  mutate("
"0","    Counselors_Total = Counselors_Under60 + Counselors_60plus,"
"0","    Counselors_Under60_Ratio = Counselors_Under60 / Counselors_Total,"
"0","    Counselors_60plus_Ratio = Counselors_60plus / Counselors_Total,"
"0","    Psychologists_Total = Psychologists_Under60 + Psychologists_60plus,"
"0","    Psychologists_Under60_Ratio = Psychologists_Under60 / Psychologists_Total,"
"0","    Psychologists_60plus_Ratio = Psychologists_60plus / Psychologists_Total"
"0","  )"
"0",""
"0","# Prepare data for plotting"
"0","counselors_age_data <- data %>%"
"0","  select(State, Counselors_Under60_Ratio, Counselors_60plus_Ratio) %>%"
"0","  gather(key = ""Age_Group"", value = ""Ratio"", Counselors_Under60_Ratio, Counselors_60plus_Ratio) %>%"
"0","  mutate(Role = ""Counselors"", Age_Group = ifelse(Age_Group == ""Counselors_Under60_Ratio"", ""Under 60"", ""60+""))"
"0",""
"0","psychologists_age_data <- data %>%"
"0","  select(State, Psychologists_Under60_Ratio, Psychologists_60plus_Ratio) %>%"
"0","  gather(key = ""Age_Group"", value = ""Ratio"", Psychologists_Under60_Ratio, Psychologists_60plus_Ratio) %>%"
"0","  mutate(Role = ""Psychologists"", Age_Group = ifelse(Age_Group == ""Psychologists_Under60_Ratio"", ""Under 60"", ""60+""))"
"0",""
"0","combined_age_data <- bind_rows(counselors_age_data, psychologists_age_data)"
"0",""
"0","# Plot age distribution for counselors and psychologists"
"0","ggplot(combined_age_data, aes(x = State, y = Ratio, fill = Age_Group)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","  facet_wrap(~ Role, scales = ""free_y"") +"
"0","  labs("
"0","    title = ""Age Distribution of Counselors and Psychologists by State"","
"0","    x = ""State"","
"0","    y = ""Proportion"""
"0","  ) +"
"0","  scale_fill_manual(values = c(""Under 60"" = ""skyblue"", ""60+"" = ""rosybrown1"")) + # Customize colors here"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 90, hjust = 1))"
"0",""
