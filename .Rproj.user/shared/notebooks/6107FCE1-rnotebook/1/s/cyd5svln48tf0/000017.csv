"0","# Calculate gender ratios for counselors and psychologists"
"0","data <- data %>%"
"0","  mutate("
"0","    Counselors_Total = Male_Counselors + Female_Counselors,"
"0","    Counselors_Male_Ratio = Male_Counselors / Counselors_Total,"
"0","    Counselors_Female_Ratio = Female_Counselors / Counselors_Total,"
"0","    Psychologists_Total = Male_Psychologists + Female_Psychologists,"
"0","    Psychologists_Male_Ratio = Male_Psychologists / Psychologists_Total,"
"0","    Psychologists_Female_Ratio = Female_Psychologists / Psychologists_Total"
"0","  )"
"0",""
"0","# Prepare data for plotting"
"0","counselors_data <- data %>%"
"0","  select(State, Counselors_Male_Ratio, Counselors_Female_Ratio) %>%"
"0","  gather(key = ""Gender"", value = ""Ratio"", Counselors_Male_Ratio, Counselors_Female_Ratio) %>%"
"0","  mutate(Role = ""Counselors"", Gender = ifelse(Gender == ""Counselors_Male_Ratio"", ""Male"", ""Female""))"
"0",""
"0","psychologists_data <- data %>%"
"0","  select(State, Psychologists_Male_Ratio, Psychologists_Female_Ratio) %>%"
"0","  gather(key = ""Gender"", value = ""Ratio"", Psychologists_Male_Ratio, Psychologists_Female_Ratio) %>%"
"0","  mutate(Role = ""Psychologists"", Gender = ifelse(Gender == ""Psychologists_Male_Ratio"", ""Male"", ""Female""))"
"0",""
"0","combined_data <- bind_rows(counselors_data, psychologists_data)"
"0",""
"0","# Plot gender distribution for counselors and psychologists"
"0","ggplot(combined_data, aes(x = State, y = Ratio, fill = Gender)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","  facet_wrap(~ Role, scales = ""free_y"") +"
"0","  labs("
"0","    title = ""Gender Distribution of Counselors and Psychologists by State"","
"0","    x = ""State"","
"0","    y = ""Proportion"""
"0","  ) +"
"0","  scale_fill_manual(values = c(""Male"" = ""skyblue"", ""Female"" = ""rosybrown1"")) +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 90, hjust = 1))"
"0",""
